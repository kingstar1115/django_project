{% load i18n static %}
{% load simpletags %}
{% get_current_language as LANGUAGE_CODE %}{% get_current_language_bidi as LANGUAGE_BIDI %}
<!DOCTYPE html>
<html lang="{{ LANGUAGE_CODE|default:"en-us" }}" {% if LANGUAGE_BIDI %}dir="rtl"{% endif %}>
<head>
    <meta charset="UTF-8">
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>{{ site_title }}</title>

    <link rel="icon" href="{% static '/admin/simpleui-x/img/favicon.png' %}">

    <link rel="stylesheet" href="https://unpkg.com/element-ui@2.7.2/lib/theme-chalk/index.css">
    <link rel="stylesheet" href="{% static '/admin/simpleui-x/fontawesome-free-5.8.1-web/css/all.min.css' %}">
    <link rel="stylesheet" href="{% static '/admin/simpleui-x/css/index.css' %}">

</head>
<body>

<div id="main">
    <el-container :style="{height: height+'px'}">

        <el-aside v-if="!fold" width="200px" class="menu">
            <div class="logo-wrap">
                <el-row>
                    <el-col :span="4">
                        <img src="{% static '/admin/simpleui-x/img/logo.png' %}">
                    </el-col>
                    <el-col :span="20">
                        <span>{{ site_header }}</span>
                    </el-col>
                </el-row>
            </div>
            <el-menu :default-openeds="['1']">
                <el-menu-item
                        @click="openTab({})"
                        index="0"><i class="fas fa-tachometer-alt"></i>首页
                </el-menu-item>
                {% if app_list %}
                    {% for app in app_list %}
                        <el-submenu index="{{ forloop.counter }}">
                            <template slot="title"><i class="el-icon-message"></i>{{ app.name|get_icon }} {{ app.name }}
                            </template>
                            <el-menu-item-group>
                                {% for model in app.models %}
                                    {% if model.admin_url %}
                                        <el-menu-item
                                                @click="openTab({url:'{{ model.admin_url }}',name:'{{ model.name }}',icon:'{{ model.name }}'})"
                                                index="{{ forloop.parentloop.counter }}-{{ forloop.counter }}">
                                            {{ model.name|get_icon }}{{ model.name }}</el-menu-item>
                                    {% endif %}
                                {% endfor %}
                            </el-menu-item-group>
                        </el-submenu>
                    {% endfor %}
                {% endif %}
            </el-menu>
        </el-aside>
        <el-container>
            <el-header class="navbar" style="font-size: 12px;padding: 10px;height: auto">
                <el-row>
                    <el-col :span="20">
                        <el-tooltip class="item" effect="dark" content="显示或隐藏菜单" placement="top-start">
                            <el-button @click="foldClick()" :icon="foldIcon"></el-button>
                        </el-tooltip>
                    </el-col>
                    <el-col :span="4">
                        <el-button :icon="this.zoom?'fas fa-compress-arrows-alt':'fas fa-expand-arrows-alt'"
                                   @click="goZoom()" circle></el-button>
                        <el-button icon="fas fa-globe-americas" @click="goIndex()" circle></el-button>
                        <el-dropdown>
                            <el-button>
                                <i class="fas fa-user"></i>
                                {{ user }}<i class="el-icon-arrow-down el-icon--right"></i>
                            </el-button>
                            <el-dropdown-menu slot="dropdown">
                                <el-dropdown-item icon="el-icon-edit" @click.native="changePassword()">修改密码
                                </el-dropdown-item>
                                <el-dropdown-item icon="el-icon-close" @click.native="logout()">退出登录</el-dropdown-item>
                            </el-dropdown-menu>
                        </el-dropdown>

                    </el-col>
                </el-row>
            </el-header>
            <el-main>
                <el-tabs v-model="tabModel" type="border-card" editable style="height: 100%" @edit="handleTabsEdit">

                    <el-tab-pane v-for="(item,index) in tabs" :closable="index!=0" :label="item.name" :name="item.id" :key="item.id">
                        <div v-if="index==0">
                            {% include './home.html' %}
                        </div>
                        <iframe v-else :src="item.url"></iframe>
                    </el-tab-pane>

                </el-tabs>
            </el-main>
        </el-container>
    </el-container>
</div>
<script src="https://cdn.jsdelivr.net/npm/vue@2.6.10/dist/vue.js"></script>
<script src="https://unpkg.com/element-ui@2.7.2/lib/index.js"></script>
<script type="text/javascript" src="{% static '/admin/simpleui-x/js/index.js' %}"></script>
</body>
</html>