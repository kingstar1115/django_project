{% load i18n static %}
{% load simpletags %}
{% get_current_language as LANGUAGE_CODE %}{% get_current_language_bidi as LANGUAGE_BIDI %}
<!DOCTYPE html>
<html lang="{{ LANGUAGE_CODE|default:"en-us" }}" {% if LANGUAGE_BIDI %}dir="rtl"{% endif %}>
<head>
    <meta charset="UTF-8">
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>{{ site_title }}</title>

    <link rel="icon" href="{% static '/admin/simpleui-x/img/favicon.png' %}">

    <link rel="stylesheet" href="https://unpkg.com/element-ui@2.7.2/lib/theme-chalk/index.css">
    <link rel="stylesheet" href="{% static '/admin/simpleui-x/fontawesome-free-5.8.1-web/css/all.min.css' %}">
    <link rel="stylesheet" href="{% static '/admin/simpleui-x/css/index.css' %}">

</head>
<body>
{% autoescape off %}
    {% menus %}
{% endautoescape %}
<div id="main" @click="mainClick($event)">
    <el-container :style="{height: height+'px'}">

        <el-aside width="auto" class="menu">
            <div class="logo-wrap" v-if="!fold">
                <el-row>
                    <el-col :span="4">
                        <img src="{% static '/admin/simpleui-x/img/logo.png' %}">
                    </el-col>
                    <el-col :span="20">
                        <span>{{ site_header }}</span>
                    </el-col>
                </el-row>
            </div>


            <el-menu default-active="1" class="el-menu-vertical-demo" :default-active="menuActive" :collapse="fold">
                <div v-for="(item,i) in menus">

                    <el-menu-item v-if="!item.models" :index="(i+1)+''" @click="openTab(item,(i+1)+'')">
                        <i class="el-icon-menu"></i>
                        <span slot="title" v-text="item.name"></span>
                    </el-menu-item>


                    <el-submenu v-else :index="(i+1)+''">
                        <template slot="title">
                            <i :class="item.icon"></i>
                            <span v-if="!fold" slot="title" v-text="item.name"></span>
                        </template>

                        <el-menu-item-group v-for="(sub,j) in item.models" :title="sub.name" :key="sub.name">
                            <el-menu-item :index="(i+1)+'-'+j" @click="openTab(sub,(i+1)+'-'+j)">
                                <i :class="sub.icon"></i>
                                <span slot="title" v-text="sub.name"></span>
                            </el-menu-item>
                        </el-menu-item-group>

                    </el-submenu>

                </div>
            </el-menu>


        </el-aside>
        <el-container>
            <el-header class="navbar" style="font-size: 12px;padding: 10px;height: auto">
                <el-row>
                    <el-col :span="20">
                        <el-tooltip class="item" effect="dark" content="显示或隐藏菜单" placement="top-start">
                            <el-button @click="foldClick()" :icon="foldIcon"></el-button>
                        </el-tooltip>
                    </el-col>
                    <el-col :span="4">
                        <el-button :icon="this.zoom?'fas fa-compress-arrows-alt':'fas fa-expand-arrows-alt'"
                                   @click="goZoom()" circle></el-button>
                        <el-button icon="fas fa-globe-americas" @click="goIndex()" circle></el-button>
                        <el-dropdown>
                            <el-button>
                                <i class="fas fa-user"></i>
                                {{ user }}<i class="el-icon-arrow-down el-icon--right"></i>
                            </el-button>
                            <el-dropdown-menu slot="dropdown">
                                <el-dropdown-item icon="far fa-edit" @click.native="changePassword()">修改密码
                                </el-dropdown-item>
                                <el-dropdown-item icon="el-icon-close" @click.native="logout()">退出登录</el-dropdown-item>
                            </el-dropdown-menu>
                        </el-dropdown>
                    </el-col>
                </el-row>
            </el-header>
            <el-main>
                <el-tabs v-model="tabModel" type="border-card" editable style="height: 100%" @edit="handleTabsEdit"
                         @tab-click="tabClick">

                    <el-tab-pane v-for="(item,index) in tabs" :closable="index!=0" :label="item.name" :name="item.id"
                                 :key="item.id">
                        <span slot="label" @contextmenu.prevent="contextmenu(item,$event)"><i
                                :class="item.icon"></i><span
                                v-text="item.name"></span></span>
                        <div v-if="index==0">
                            {% include './home.html' %}
                        </div>
                        <iframe v-else :src="item.url"></iframe>
                    </el-tab-pane>

                </el-tabs>
            </el-main>
        </el-container>
    </el-container>

    <ul v-if="popup.show" class="el-dropdown-menu el-popper"
        :style="{position: 'absolute',top: popup.top+'px',left: popup.left+'px'}" x-placement="top-end">
        <li v-for="(item,index) in popup.menus" tabindex="-1" class="el-dropdown-menu__item"
            @click="item.handler(popup.tab,item)"><i :class="item.icon"></i><span
                v-text="item.text"></span>
        </li>
    </ul>
</div>
<script src="https://cdn.jsdelivr.net/npm/vue@2.6.10/dist/vue.js"></script>
<script src="https://unpkg.com/element-ui@2.7.2/lib/index.js"></script>
<script type="text/javascript" src="{% static '/admin/simpleui-x/js/index.js' %}"></script>
</body>
</html>